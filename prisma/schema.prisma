generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id            String         @id @default(uuid())
  nome          String
  cpf           String         @unique
  telefone      String
  createdAt     DateTime       @default(now())
  participacoes Participante[]
}

model Bolao {
  id             String         @id @default(uuid())
  concurso       String
  dataSorteio    DateTime
  premioEstimado Float
  valorCota      Float
  dataCriacao    DateTime       @default(now())
  ativo          Boolean        @default(true) // Define qual é o bolão atual da tela
  aberto         Boolean        @default(true) // NOVA: Define se aceita pagamentos
  resultado      String?
  
  participantes  Participante[]
  apostas        ApostaRealizada[]
}

model Participante {
  id            String    @id @default(uuid())
  bolaoId       String
  usuarioId     String
  nomesCotas    String[]
  quantidade    Int
  valorTotal    Float
  status        String    @default("pendente")
  paymentId     String?
  dataPagamento DateTime?
  createdAt     DateTime  @default(now())

  bolao   Bolao   @relation(fields: [bolaoId], references: [id], onDelete: Cascade)
  usuario Usuario @relation(fields: [usuarioId], references: [id])
}

// SEU BANCO DE DADOS PESSOAL DE JOGOS
model CatalogoJogos {
  id        String   @id @default(uuid())
  nome      String   // Ex: "Jogo da Vó", "Estatística Jan/24"
  numeros   Int[]    // Array de números: [1, 15, 22, 30, 45, 60]
  criadoEm  DateTime @default(now())
}

// JOGOS QUE FORAM EFETIVAMENTE JOGADOS NO BOLÃO
model ApostaRealizada {
  id        String   @id @default(uuid())
  bolaoId   String
  numeros   Int[]    // Os números jogados
  origem    String?  // Ex: "Importado do Catálogo" ou "Gerado Auto"
  
  bolao     Bolao    @relation(fields: [bolaoId], references: [id], onDelete: Cascade)
}